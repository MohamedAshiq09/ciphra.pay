# ============================================================================
# CIPHRA.PAY BACKEND - ENVIRONMENT CONFIGURATION
# Cross-Chain Privacy Payment Infrastructure
# ============================================================================

# ----------------------------------------------------------------------------
# Network Environment
# ----------------------------------------------------------------------------
NODE_ENV=development
PORT=3000

# ----------------------------------------------------------------------------
# AZTEC CONFIGURATION
# ----------------------------------------------------------------------------
AZTEC_PXE_URL=http://localhost:8080
AZTEC_CONTRACT_ADDRESS=0x00e21e61cc1abe9bde42e4cb267b8e6342c3f4de149cab6d12dfa2037813754c    # PrivateAtomicSwap V3 (deployed on local sandbox)
AZTEC_WALLET_PRIVATE_KEY=0x...  # Backend oracle wallet private key
AZTEC_WALLET_SALT=1             # Salt for wallet derivation

# Polling Configuration
AZTEC_POLL_INTERVAL=5000        # Poll public state every 5 seconds

# ----------------------------------------------------------------------------
# STARKNET CONFIGURATION
# ----------------------------------------------------------------------------
# Network: starknet-mainnet | starknet-sepolia | starknet-devnet
STARKNET_NETWORK=starknet-sepolia
STARKNET_RPC_URL=https://rpc.nethermind.io/sepolia-juno/

# Contract Addresses (from deployment)
STARKNET_ATOMIC_SWAP_ADDRESS=0x...
STARKNET_BRIDGE_CONNECTOR_ADDRESS=0x...
STARKNET_ESCROW_ADDRESS=0x...
STARKNET_P2P_TRANSFER_ADDRESS=0x...

# Backend Oracle Wallet
STARKNET_WALLET_PRIVATE_KEY=0x...
STARKNET_WALLET_ADDRESS=0x...

# Event Monitoring
STARKNET_START_BLOCK=latest     # Or specific block number
STARKNET_POLL_INTERVAL=5000     # Poll events every 5 seconds

# ----------------------------------------------------------------------------
# NEAR CONFIGURATION
# ----------------------------------------------------------------------------
# Network: mainnet | testnet
NEAR_NETWORK=testnet
NEAR_RPC_URL=https://rpc.testnet.near.org

# Contract Accounts
NEAR_ATOMIC_SWAP_CONTRACT=dev-123-atomic-swap.testnet
NEAR_BRIDGE_CONTRACT=dev-123-bridge.testnet

# Backend Oracle Account
NEAR_ORACLE_ACCOUNT_ID=oracle.testnet
NEAR_ORACLE_PRIVATE_KEY=ed25519:...

# Event Monitoring
NEAR_START_BLOCK_HEIGHT=0       # Or specific block height
NEAR_POLL_INTERVAL=2000         # Poll blocks every 2 seconds

# ----------------------------------------------------------------------------
# X402 PAYMENT PROTOCOL (Starknet)
# ----------------------------------------------------------------------------
# Default paymaster endpoints per network
PAYMASTER_ENDPOINT_MAINNET=https://starknet.paymaster.avnu.fi
PAYMASTER_ENDPOINT_SEPOLIA=https://sepolia.paymaster.avnu.fi
PAYMASTER_ENDPOINT_DEVNET=http://localhost:12777

# Active paymaster (based on STARKNET_NETWORK)
PAYMASTER_ENDPOINT=https://sepolia.paymaster.avnu.fi
PAYMASTER_API_KEY=                  # Optional for mainnet

# Payment Configuration
X402_PAYMENT_TOKEN_ADDRESS=0x049d36570d4e46f48e99674bd3fcc84644ddd6b96f7c741b1562b82f9e004dc7  # ETH on Sepolia
X402_PAYMENT_AMOUNT=1000000         # 0.001 ETH (in wei equivalent)
X402_PAYMENT_RECIPIENT=0x...        # Backend wallet to receive payments
X402_MAX_TIMEOUT_SECONDS=300        # 5 minutes

# ----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# ----------------------------------------------------------------------------
DATABASE_HOST=localhost
DATABASE_PORT=5432
DATABASE_NAME=ciphra_pay
DATABASE_USER=postgres
DATABASE_PASSWORD=your_secure_password
DATABASE_SSL=false
DATABASE_LOGGING=false

# PostgreSQL Connection URL (alternative to individual fields)
DATABASE_URL=postgresql://postgres:your_secure_password@localhost:5432/ciphra_pay

# ----------------------------------------------------------------------------
# REDIS CONFIGURATION (for Bull queues)
# ----------------------------------------------------------------------------
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=                     # Leave empty if no password
REDIS_DB=0

# Redis Connection URL (alternative)
REDIS_URL=redis://localhost:6379

# ----------------------------------------------------------------------------
# SECURITY
# ----------------------------------------------------------------------------
# JWT for API authentication
JWT_SECRET=your_super_secret_jwt_key_change_this_in_production_min_32_chars
JWT_EXPIRATION=24h

# Admin API Key (for admin endpoints)
ADMIN_API_KEY=your_admin_api_key_change_this_in_production

# CORS Configuration
CORS_ORIGIN=http://localhost:3001  # Frontend URL
CORS_CREDENTIALS=true

# Rate Limiting
RATE_LIMIT_TTL=60                  # Time window in seconds
RATE_LIMIT_MAX=100                 # Max requests per window

# ----------------------------------------------------------------------------
# HASH ORACLE CONFIGURATION
# ----------------------------------------------------------------------------
# Enable hash compatibility oracle
HASH_ORACLE_ENABLED=true

# Secret generation
SECRET_LENGTH=32                    # 32 bytes = 256 bits

# Hash algorithm mapping
# NEAR: SHA256
# Starknet: Poseidon
# Aztec: Pedersen

# ----------------------------------------------------------------------------
# MONITORING & LOGGING
# ----------------------------------------------------------------------------
LOG_LEVEL=debug                     # debug | info | warn | error
LOG_FORMAT=json                     # json | simple
LOG_INCLUDE_TIMESTAMP=true

# Sentry (Optional - for error tracking)
SENTRY_DSN=
SENTRY_ENVIRONMENT=development

# ----------------------------------------------------------------------------
# SWAP COORDINATION
# ----------------------------------------------------------------------------
# Automatic swap coordination
AUTO_COORDINATE_SWAPS=true

# Time lock configuration (seconds)
DEFAULT_TIME_LOCK_DURATION=3600     # 1 hour
MIN_TIME_LOCK_DURATION=3600         # 1 hour minimum
MAX_TIME_LOCK_DURATION=172800       # 48 hours maximum

# Fee Configuration
DEFAULT_FEE_PERCENTAGE=30           # 0.3% = 30 basis points
MAX_FEE_PERCENTAGE=1000             # 10% = 1000 basis points

# ----------------------------------------------------------------------------
# SUPPORTED CHAINS
# ----------------------------------------------------------------------------
# Chain identifiers (as Field values in contracts)
CHAIN_ID_AZTEC=0
CHAIN_ID_STARKNET=1
CHAIN_ID_NEAR=2
CHAIN_ID_ZCASH=3

# Chain name mapping
CHAIN_NAME_0=aztec
CHAIN_NAME_1=starknet
CHAIN_NAME_2=near
CHAIN_NAME_3=zcash

# ----------------------------------------------------------------------------
# BULL QUEUE CONFIGURATION
# ----------------------------------------------------------------------------
# Queue names
QUEUE_AZTEC_MONITOR=aztec-monitor
QUEUE_STARKNET_MONITOR=starknet-monitor
QUEUE_NEAR_MONITOR=near-monitor
QUEUE_SWAP_COORDINATOR=swap-coordinator

# Queue settings
QUEUE_MAX_RETRIES=3
QUEUE_RETRY_DELAY=5000              # 5 seconds

# ----------------------------------------------------------------------------
# TESTING (for development/testing only)
# ----------------------------------------------------------------------------
# Test mode (skips some validations)
TEST_MODE=false

# Mock RPC endpoints
MOCK_AZTEC_PXE=false
MOCK_STARKNET_RPC=false
MOCK_NEAR_RPC=false

# Test accounts
TEST_AZTEC_ACCOUNT=0x...
TEST_STARKNET_ACCOUNT=0x...
TEST_NEAR_ACCOUNT=test.testnet

# ----------------------------------------------------------------------------
# DEPLOYMENT
# ----------------------------------------------------------------------------
# Health check configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30000         # 30 seconds

# Graceful shutdown timeout
SHUTDOWN_TIMEOUT=10000              # 10 seconds

# ----------------------------------------------------------------------------
# NOTES
# ----------------------------------------------------------------------------
# 1. NEVER commit this file with real private keys
# 2. In production, use proper secrets management (AWS Secrets Manager, HashiCorp Vault, etc.)
# 3. Rotate keys regularly
# 4. Use environment-specific .env files (.env.development, .env.production)
# 5. Contract addresses must be set after deployment
# 6. Ensure all oracle wallets are funded with gas tokens
